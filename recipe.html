<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>

  <style>
    body {
      background: radial-gradient(circle, rgb(253, 246, 148), white);
    }

    #sidesearch {

      margin-left: 50px;

      /* background-color: lightgrey; */
    }

    .brand-logo {
      margin-left: 100px;

    }
  </style>

  <!-- Compiled and minified CSS -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css">
</head>

<body>

  <nav>
    <div class="nav-wrapper">
      <a href="#" class="brand-logo">Recipe Search</a>
      <ul id="nav-mobile" class="right hide-on-med-and-down">
        <li><a href="sass.html">Sass</a></li>
        <li><a href="badges.html">Components</a></li>
        <li><a href="collapsible.html">JavaScript</a></li>
      </ul>
    </div>
  </nav>

  <!-- Page Layout here -->
  <div id="sidesearch" class="row">

    <div class="col s3">
      <form>
        <p>
          <label for="name">Recipe name</label>
          <input type="text" name="name" id="name">
        </p>
        <button id="search">Search for Recipe</button>
      </form>
      <!-- <div id="RecipeDisplay"></div> -->
    </div>

    <div class="col s9">
      <div id="ingredients"></div>
    </div>

  </div>

  <div id="recipe">

  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>

  <script>
    document.getElementById('search').addEventListener('click', event => {
      event.preventDefault()

    //axios.get(`https://api.spoonacular.com/recipes/complexSearch?query=pasta&apiKey=d7ef68f1acc34dedb93dd4613a30a40f&includeNutrition=true`)
    axios.get(`https://api.spoonacular.com/recipes/complexSearch?query=${name}&apiKey=f305efd996cc4fa489c91ad83e4232a4`)

    // axios.get('https://api.spoonacular.com/recipes/extract?url=https://foodista.com/recipe/ZHK4KPB6/chocolate-crinkle-cookies&apiKey=f305efd996cc4fa489c91ad83e4232a4&includeNutrition=true')
      // axios.get('https://api.spoonacular.com/recipes/716429/information?apiKey=d7ef68f1acc34dedb93dd4613a30a40f&includeNutrition=true')
      .then(res => {

          let ingredients = res.data.results

          console.log(ingredients)

        for (let i = 0; i < 1; i++) {

            console.log(i)

            document.getElementById('ingredients').innerHTML += `
            <h5>dish: ${ingredients[i].title}</h5>
            <img src="${ingredients[i].image}" alt="${ingredients.title}"
            >
            <button data-recipe_id="${ingredients[i].id}" class="recipeclass">see recipe</button>
            `

            document.getElementById('name').value = ''

          document.getElementById('ingredients').value = ''
        }
      })

        .catch(err => {
          console.error(err)
        })

      document.addEventListener('click', event =>{
        
        if (event.target.classList.contains('recipeclass')) {
          
          console.log('hi')
          
          axios.get(`https://api.spoonacular.com/recipes/${event.target.dataset.recipe_id}/information?apiKey=f305efd996cc4fa489c91ad83e4232a4&includeNutrition=true`)
          
          
          .then(res => {
            
            let recipe = res.data
            
            console.log(recipe)

        for (let i=0; i < recipe.extendedIngredients; i++){

            document.getElementById('recipe').innerHTML = `
            <div>
              <h2>Ingredients:</h2>
              <ul>
                <li>${recipe.extendedIngredients[i].original}</li>
                </ul>
              </div>
                <h2>Instructions:</h2>
                <p>${ingredients.instructions}</p>
                `
              
                //  < li > ${ recipe.extendedIngredients[i].original }</ >
                // <li>${recipe.extendedIngredients[i].original}</li>
                // <li>${recipe.extendedIngredients[i].original}</li>
                // <li>${recipe.extendedIngredients[4].original}</li>
                // <li>${recipe.extendedIngredients[5].original}</li>
                // <li>${recipe.extendedIngredients[6].original}</li>
                // <li>${recipe.extendedIngredients[7].original}</li>
                // <li>${recipe.extendedIngredients[8].original}</li>
                // <li>${recipe.extendedIngredients[9].original}</li>
                // document.getElementById('recipe').innerHTML = `
                //     <p>recipe: ${recipe.instructions}</p>
                //  
                  //  `
              }
              })
              .catch(err => {
                console.error(err)
              })
            }
          })
            
      })
          
          
   </script>
</body>
</html>